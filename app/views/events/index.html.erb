<% content_for :main do %>
  <section>
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1 events">
          <div class="row">
            <div class="col-sm-12 instructions">
              <div class="col-sm-2 expand">
                Click Date to Expand <%= fa_icon 'caret-down' %>
              </div>
              <div class="col-sm-4 col-sm-offset-2">
                <%= text_field_tag 'search', nil, class: 'search', placeholder: 'Search Events' %>
              </div>
              <div class="col-sm-2 col-sm-offset-2 toggle-all">
                <%= link_to 'Close All', '#', class: 'btn btn-default', id: 'close-all' %>
                <%= link_to 'Expand All', '#', class: 'btn btn-default', id: 'expand-all' %>
              </div>
            </div>
            <div class="col-sm-12 months">
              <div class="row">
                <% next_12_months.each do |month| %>
                  <div class="col-sm-1">
                    <%= link_to month[:name], '#', data: {month: "#{month[:index]}#{month[:year]}"}, class: 'month' %>
                  </div>
                <% end %>
              </div>
            </div>
            <% @events_by_date.each do |date, events| %>
              <div class="col-sm-12">
                <div class="date">
                  <div class="date-header header" id="<%= "#{date.month}#{date.year}" %>">
                    <%= formatted_date(date) %>
                  </div>
                  <div class="date-content">
                    <% events.each do |event| %>
                      <div class="event">
                        <div class="col-sm-12 col-md-5 title">
                          <%= truncated_string(event.headliner) %>
                        </div>
                        <div class="col-sm-12 col-md-5 info">
                          <%= formatted_time(event.time) %>
                          @ <%= link_to event.venue.name, venue_path(event.venue.id), class: 'body-link' %>
                          <div class="price">
                            <%= event.price %>
                          </div>
                        </div>
                        <div class="col-sm-12 col-md-2 tickets">
                          <%= link_to (fa_icon 'map-marker'), '#', class: 'map-icon', data: {venue_id: event.venue.id} %>
                          <%= link_to (fa_icon 'ticket'), event.tickets %>
                        </div>
                      </div>
                    <% end %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
        <div class="col-sm-10 col-sm-offset-1 no-events">
          <h1>No Events Match Your Search</h1>
        </div>
      </div>
    </div>
    <div id="map-container"></div>
  </section>
<% end %>

<% content_for :script do %>
  <script type="text/javascript"
          src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
  <script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/src/infobox.js"></script>
  <%= javascript_include_tag 'events-index' %>
<% end %>